<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Demiurge::Agent
  
    &mdash; Demiurge API Documentation
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Demiurge::Agent";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Demiurge.html" title="Demiurge (module)">Demiurge</a></span></span>
     &raquo; 
    <span class="title">Agent</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Demiurge::Agent
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="ActionItem.html" title="Demiurge::ActionItem (class)">ActionItem</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="StateItem.html" title="Demiurge::StateItem (class)">StateItem</a></span></li>
          
            <li class="next"><span class='object_link'><a href="ActionItem.html" title="Demiurge::ActionItem (class)">ActionItem</a></span></li>
          
            <li class="next">Demiurge::Agent</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/demiurge/agent.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Agents correspond roughly to “mobiles” in many games. An agent isn&#39;t
particularly different from other Demiurge objects, but it&#39;s useful to
have some helper classes for things like pathfinding. Also, humans expect
agents to have some finite ability to perform actions over time, so
it&#39;s nice to regulate how much an agent can get done and how “busy” it
is. This keeps an AI agent from just queueing up 30 move intentions and
crossing the room in a single tick, for instance. It does <em>not</em> keep
that same AI from having an intentional 30-square move that works in a
single tick, but it slows the rate of actions. Agents get a single “real”
intention, unlike, say, rooms, which can have lots going on at once.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.0.1</p>
</div>
      
    </li>
  
</ul>

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="WanderingAgent.html" title="Demiurge::WanderingAgent (class)">WanderingAgent</a></span></p>
</div>



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants inherited
     from <span class='object_link'><a href="ActionItem.html" title="Demiurge::ActionItem (class)">ActionItem</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ActionItem.html#ACTION_LEGAL_KEYS-constant" title="Demiurge::ActionItem::ACTION_LEGAL_KEYS (constant)">Demiurge::ActionItem::ACTION_LEGAL_KEYS</a></span></p>




  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="StateItem.html" title="Demiurge::StateItem (class)">StateItem</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="StateItem.html#engine-instance_method" title="Demiurge::StateItem#engine (method)">#engine</a></span>, <span class='object_link'><a href="StateItem.html#name-instance_method" title="Demiurge::StateItem#name (method)">#name</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#agent%3F-instance_method" title="#agent? (instance method)">#<strong>agent?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>An Agent is, indeed, an Agent.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear_intention_queue-instance_method" title="#clear_intention_queue (instance method)">#<strong>clear_intention_queue</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Any queued actions waiting to occur will be discarded.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finished_init-instance_method" title="#finished_init (instance method)">#<strong>finished_init</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(*args)  &#x21d2; Agent </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Agent.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#intentions_for_next_step-instance_method" title="#intentions_for_next_step (instance method)">#<strong>intentions_for_next_step</strong>  &#x21d2; Array&lt;Intention&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Calculate the agent&#39;s intentions for the following tick.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_to_position-instance_method" title="#move_to_position (instance method)">#<strong>move_to_position</strong>(pos)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method will move the agent and notify about that change.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#queue_action-instance_method" title="#queue_action (instance method)">#<strong>queue_action</strong>(action_name, *args)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Queue an action to be run after previous actions are complete, and when the
agent is no longer busy from taking them.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="ActionItem.html" title="Demiurge::ActionItem (class)">ActionItem</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ActionItem.html#__state_internal-instance_method" title="Demiurge::ActionItem#__state_internal (method)">#__state_internal</a></span>, <span class='object_link'><a href="ActionItem.html#get_action-instance_method" title="Demiurge::ActionItem#get_action (method)">#get_action</a></span>, <span class='object_link'><a href="ActionItem.html#get_actions_with_tags-instance_method" title="Demiurge::ActionItem#get_actions_with_tags (method)">#get_actions_with_tags</a></span>, <span class='object_link'><a href="ActionItem.html#location-instance_method" title="Demiurge::ActionItem#location (method)">#location</a></span>, <span class='object_link'><a href="ActionItem.html#location_name-instance_method" title="Demiurge::ActionItem#location_name (method)">#location_name</a></span>, <span class='object_link'><a href="ActionItem.html#position-instance_method" title="Demiurge::ActionItem#position (method)">#position</a></span>, <span class='object_link'><a href="ActionItem.html#register_actions-instance_method" title="Demiurge::ActionItem#register_actions (method)">#register_actions</a></span>, <span class='object_link'><a href="ActionItem.html#run_action-instance_method" title="Demiurge::ActionItem#run_action (method)">#run_action</a></span>, <span class='object_link'><a href="ActionItem.html#zone-instance_method" title="Demiurge::ActionItem#zone (method)">#zone</a></span>, <span class='object_link'><a href="ActionItem.html#zone_name-instance_method" title="Demiurge::ActionItem#zone_name (method)">#zone_name</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="StateItem.html" title="Demiurge::StateItem (class)">StateItem</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="StateItem.html#from_name_type-class_method" title="Demiurge::StateItem.from_name_type (method)">from_name_type</a></span>, <span class='object_link'><a href="StateItem.html#get_structure-instance_method" title="Demiurge::StateItem#get_structure (method)">#get_structure</a></span>, <span class='object_link'><a href="StateItem.html#state-instance_method" title="Demiurge::StateItem#state (method)">#state</a></span>, <span class='object_link'><a href="StateItem.html#state_type-instance_method" title="Demiurge::StateItem#state_type (method)">#state_type</a></span>, <span class='object_link'><a href="StateItem.html#zone%3F-instance_method" title="Demiurge::StateItem#zone? (method)">#zone?</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(*args)  &#x21d2; <tt><span class='object_link'><a href="" title="Demiurge::Agent (class)">Agent</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Agent</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/demiurge/agent.rb', line 18</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
  <span class='id identifier rubyid_state'>state</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>queued_actions</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_state'>state</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>queue_number</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="agent?-instance_method">
  
    #<strong>agent?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>An Agent is, indeed, an Agent.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Return true for Agent and its subclasses.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/demiurge/agent.rb', line 34</span>

<span class='kw'>def</span> <span class='id identifier rubyid_agent?'>agent?</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="clear_intention_queue-instance_method">
  
    #<strong>clear_intention_queue</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Any queued actions waiting to occur will be discarded.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


102
103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/demiurge/agent.rb', line 102</span>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_intention_queue'>clear_intention_queue</span>
  <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>queued_actions</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="finished_init-instance_method">
  
    #<strong>finished_init</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/demiurge/agent.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_finished_init'>finished_init</span>
  <span class='kw'>super</span>
  <span class='ivar'>@agent_maintenance</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="AgentInternal.html" title="Demiurge::AgentInternal (module)">AgentInternal</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="AgentInternal/AgentMaintenanceIntention.html" title="Demiurge::AgentInternal::AgentMaintenanceIntention (class)">AgentMaintenanceIntention</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="AgentInternal/AgentMaintenanceIntention.html#initialize-instance_method" title="Demiurge::AgentInternal::AgentMaintenanceIntention#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_engine'>engine</span><span class='comma'>,</span> <span class='ivar'>@name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_state'>state</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>busy</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>0</span> <span class='comment'># By default, start out idle.
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="intentions_for_next_step-instance_method">
  
    #<strong>intentions_for_next_step</strong>  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="Intention.html" title="Demiurge::Intention (class)">Intention</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Calculate the agent&#39;s intentions for the following tick. These
Intentions can potentially trigger other Intentions.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Intention.html" title="Demiurge::Intention (class)">Intention</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The Intentions for the (first part of the) following tick.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78
79</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/demiurge/agent.rb', line 76</span>

<span class='kw'>def</span> <span class='id identifier rubyid_intentions_for_next_step'>intentions_for_next_step</span>
  <span class='id identifier rubyid_agent_action'>agent_action</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="AgentInternal.html" title="Demiurge::AgentInternal (module)">AgentInternal</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="AgentInternal/AgentActionIntention.html" title="Demiurge::AgentInternal::AgentActionIntention (class)">AgentActionIntention</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="AgentInternal/AgentActionIntention.html#initialize-instance_method" title="Demiurge::AgentInternal::AgentActionIntention#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='ivar'>@name</span><span class='comma'>,</span> <span class='id identifier rubyid_engine'>engine</span><span class='rparen'>)</span>
  <span class='kw'>super</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='ivar'>@agent_maintenance</span><span class='comma'>,</span> <span class='id identifier rubyid_agent_action'>agent_action</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_to_position-instance_method">
  
    #<strong>move_to_position</strong>(pos)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>This method will move the agent and notify about that change. It
doesn&#39;t use an intention or an agent&#39;s action queue, and it
doesn&#39;t wait for a tick to happen. It just does it. The method
<em>does</em> handle exits and generally allows the location to respond.
But it&#39;s assumed that the offer cycle, if it needs to happen, has
happened already.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pos</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A position string to move to</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/demiurge/agent.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_to_position'>move_to_position</span><span class='lparen'>(</span><span class='id identifier rubyid_pos'>pos</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_old_pos'>old_pos</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_position'>position</span>
  <span class='id identifier rubyid_old_loc'>old_loc</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_location_name'>location_name</span>
  <span class='id identifier rubyid_old_zone_name'>old_zone_name</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_zone_name'>zone_name</span>
  <span class='id identifier rubyid_expected_new_loc'>expected_new_loc</span> <span class='op'>=</span> <span class='id identifier rubyid_pos'>pos</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_expected_new_loc'>expected_new_loc</span> <span class='op'>==</span> <span class='id identifier rubyid_old_loc'>old_loc</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_item_change_position'>item_change_position</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_old_pos'>old_pos</span><span class='comma'>,</span> <span class='id identifier rubyid_pos'>pos</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='comment'># This also handles zone changes.
</span>    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_item_change_location'>item_change_location</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_old_pos'>old_pos</span><span class='comma'>,</span> <span class='id identifier rubyid_pos'>pos</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='comment'># We&#39;re not guaranteed to wind up where we expected, so get the
</span>  <span class='comment'># new location *after* item_change_location or
</span>  <span class='comment'># item_change_position.
</span>  <span class='id identifier rubyid_new_loc'>new_loc</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_location_name'>location_name</span>

  <span class='ivar'>@engine</span><span class='period'>.</span><span class='id identifier rubyid_send_notification'>send_notification</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>old_position:</span> <span class='id identifier rubyid_old_pos'>old_pos</span><span class='comma'>,</span> <span class='label'>old_location:</span> <span class='id identifier rubyid_old_loc'>old_loc</span><span class='comma'>,</span> <span class='label'>new_position:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_position'>position</span><span class='comma'>,</span> <span class='label'>new_location:</span> <span class='id identifier rubyid_new_loc'>new_loc</span> <span class='rbrace'>}</span><span class='comma'>,</span>
                              <span class='label'>type:</span> <span class='const'><span class='object_link'><a href="../Demiurge.html" title="Demiurge (module)">Demiurge</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Notifications.html" title="Demiurge::Notifications (module)">Notifications</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Notifications.html#MoveFrom-constant" title="Demiurge::Notifications::MoveFrom (constant)">MoveFrom</a></span></span><span class='comma'>,</span> <span class='label'>zone:</span> <span class='id identifier rubyid_old_zone_name'>old_zone_name</span><span class='comma'>,</span> <span class='label'>location:</span> <span class='id identifier rubyid_old_loc'>old_loc</span><span class='comma'>,</span> <span class='label'>actor:</span> <span class='ivar'>@name</span><span class='comma'>,</span> <span class='label'>include_context:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='ivar'>@engine</span><span class='period'>.</span><span class='id identifier rubyid_send_notification'>send_notification</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>old_position:</span> <span class='id identifier rubyid_old_pos'>old_pos</span><span class='comma'>,</span> <span class='label'>old_location:</span> <span class='id identifier rubyid_old_loc'>old_loc</span><span class='comma'>,</span> <span class='label'>new_position:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_position'>position</span><span class='comma'>,</span> <span class='label'>new_location:</span> <span class='id identifier rubyid_new_loc'>new_loc</span> <span class='rbrace'>}</span><span class='comma'>,</span>
                              <span class='label'>type:</span> <span class='const'><span class='object_link'><a href="../Demiurge.html" title="Demiurge (module)">Demiurge</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Notifications.html" title="Demiurge::Notifications (module)">Notifications</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Notifications.html#MoveTo-constant" title="Demiurge::Notifications::MoveTo (constant)">MoveTo</a></span></span><span class='comma'>,</span> <span class='label'>zone:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_zone_name'>zone_name</span><span class='comma'>,</span> <span class='label'>location:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_location_name'>location_name</span><span class='comma'>,</span> <span class='label'>actor:</span> <span class='ivar'>@name</span><span class='comma'>,</span> <span class='label'>include_context:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="queue_action-instance_method">
  
    #<strong>queue_action</strong>(action_name, *args)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Queue an action to be run after previous actions are complete, and when the
agent is no longer busy from taking them. The action queue entry is
assigned a unique-per-agent queue number, which is returned from this
action.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>action_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the action to take when possible</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Additional arguments to pass to the action&#39;s code block</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns the queue number for this action - note that queue numbers are only
unique per-agent</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Errors/NoSuchActionError.html" title="Demiurge::Errors::NoSuchActionError (class)">::Demiurge::Errors::NoSuchActionError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.0.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


90
91
92
93
94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/demiurge/agent.rb', line 90</span>

<span class='kw'>def</span> <span class='id identifier rubyid_queue_action'>queue_action</span><span class='lparen'>(</span><span class='id identifier rubyid_action_name'>action_name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../Demiurge.html" title="Demiurge (module)">Demiurge</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Errors.html" title="Demiurge::Errors (module)">Errors</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Errors/NoSuchActionError.html" title="Demiurge::Errors::NoSuchActionError (class)">NoSuchActionError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Errors/Exception.html#initialize-instance_method" title="Demiurge::Errors::Exception#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Not an action: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_action_name'>action_name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>action_name</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_action_name'>action_name</span> <span class='rbrace'>}</span><span class='comma'>,</span>
                                                  <span class='label'>execution_context:</span> <span class='ivar'>@engine</span><span class='period'>.</span><span class='id identifier rubyid_execution_context'>execution_context</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_get_action'>get_action</span><span class='lparen'>(</span><span class='id identifier rubyid_action_name'>action_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_state'>state</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>queue_number</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_state'>state</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>queued_actions</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_action_name'>action_name</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_state'>state</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>queue_number</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_state'>state</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>queue_number</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Jan 16 12:25:08 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>